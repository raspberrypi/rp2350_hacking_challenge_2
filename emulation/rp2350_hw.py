"""
RP2350 Hardware Register Definitions for Emulation
"""

# Memory bases
SRAM_BASE = 0x20000000
SRAM_SCRATCH_X_BASE = 0x20080000
SRAM_SCRATCH_Y_BASE = 0x20081000
SRAM_END = 0x20082000

# Peripheral bases
RESETS_BASE = 0x40020000
ROSC_BASE = 0x400e8000
TRNG_BASE = 0x400f0000
SHA256_BASE = 0x400f8000

# RESETS register offsets
RESETS_RESET_OFFSET = 0x00000000
RESETS_RESET_SHA256_BITS = 0x00020000
RESETS_RESET_TRNG_BITS = 0x02000000

# TRNG register offsets
TRNG_RNG_IMR_OFFSET = 0x00000100
TRNG_RNG_ISR_OFFSET = 0x00000104
TRNG_RNG_ICR_OFFSET = 0x00000108
TRNG_TRNG_CONFIG_OFFSET = 0x0000010c
TRNG_TRNG_VALID_OFFSET = 0x00000110
TRNG_EHR_DATA0_OFFSET = 0x00000114
TRNG_EHR_DATA1_OFFSET = 0x00000118
TRNG_EHR_DATA2_OFFSET = 0x0000011c
TRNG_EHR_DATA3_OFFSET = 0x00000120
TRNG_EHR_DATA4_OFFSET = 0x00000124
TRNG_EHR_DATA5_OFFSET = 0x00000128
TRNG_RND_SOURCE_ENABLE_OFFSET = 0x0000012c
TRNG_SAMPLE_CNT1_OFFSET = 0x00000130
TRNG_TRNG_DEBUG_CONTROL_OFFSET = 0x00000138
TRNG_TRNG_SW_RESET_OFFSET = 0x00000140
TRNG_TRNG_BUSY_OFFSET = 0x000001b8

# SHA256 register offsets
SHA256_CSR_OFFSET = 0x00000000
SHA256_WDATA_OFFSET = 0x00000004
SHA256_SUM0_OFFSET = 0x00000008
SHA256_SUM1_OFFSET = 0x0000000c
SHA256_SUM2_OFFSET = 0x00000010
SHA256_SUM3_OFFSET = 0x00000014
SHA256_SUM4_OFFSET = 0x00000018
SHA256_SUM5_OFFSET = 0x0000001c
SHA256_SUM6_OFFSET = 0x00000020
SHA256_SUM7_OFFSET = 0x00000024

# SHA256 CSR bits
SHA256_CSR_START_BITS = 0x00000001
SHA256_CSR_START_LSB = 0
SHA256_CSR_WDATA_RDY_BITS = 0x00000002
SHA256_CSR_SUM_VLD_BITS = 0x00000004
SHA256_CSR_SUM_VLD_LSB = 2
SHA256_CSR_BSWAP_BITS = 0x00001000
SHA256_CSR_BSWAP_LSB = 12
SHA256_CSR_RESET = 0x00001206  # Default value with BSWAP=1, DMA_SIZE=2, SUM_VLD=1, WDATA_RDY=1

# ROSC register offsets
ROSC_CTRL_OFFSET = 0x00000000
ROSC_FREQA_OFFSET = 0x00000004
ROSC_FREQB_OFFSET = 0x00000008
ROSC_RANDOM_OFFSET = 0x0000000c
ROSC_DORMANT_OFFSET = 0x00000010
ROSC_DIV_OFFSET = 0x00000014
ROSC_PHASE_OFFSET = 0x00000018
ROSC_STATUS_OFFSET = 0x0000001c
ROSC_RANDOMBIT_OFFSET = 0x00000020
ROSC_COUNT_OFFSET = 0x00000024

# Config flags from CMakeLists.txt
CONFIG = {
    'RC_COUNT': 0,
    'HARDENING': 0,
    'DOUBLE_HARDENING': 0,
    'INLINE_REF_ROUNDKEY_SHARES_S': 1,
    'INLINE_REF_ROUNDKEY_HVPERMS_S': 1,
    'INLINE_SHIFT_ROWS_S': 1,
    'INLINE_MAP_SBOX_S': 1,
    'CALLER_INIT_RCP_COUNT': 1,
    # From config.h defaults
    'GEN_RAND_SHA': 1,
    'ST_SHAREC': 1,
    'ST_VPERM': 1,
    'CT_BPERM': 1,
    'RK_ROR': 1,
    'WIPE_MEMORY': 0,
    'RC_CANARY': 0,  # User specified this is 0
    'RC_JITTER': 0,
    'SH_JITTER': 1,
    'CK_JITTER': 1,
    'REFCHAFF_PERIOD': 1,
    'REMAP_PERIOD': 4,
    'REFROUNDKEYSHARES_PERIOD': 1,
    'REFROUNDKEYHVPERMS_PERIOD': 1,
    'NUMREFSTATEVPERM': 7,
    'FIB_WORKAROUND': 0,
}
